\chapter{本质边界条件施加方法}
由于无网格形函数通常不具备插值特性，因此伽辽金无网格法需要通过弱形式施加本质边界条件。
在本章中，将以弹性力学问题和薄板问题为例，对常见的3种无网格法本质边界条件施加方法进行详细讨论，包括拉格朗日乘子法、罚函数法、Nitsche法。
\section{拉格朗日乘子法}
拉格朗日乘子法最早由Belytschko等人\cite{belytschko1994}引入伽辽金无网格法中施加本质边界条件，该方法在原有的势能泛函的基础上引入拉格朗日乘子项施加本质边界条件。在弹性力学问题中，在势能泛函(\ref{elasticity potential functional})的基础上增加拉格朗日乘子项有：
\begin{equation}\label{Elambda}
\begin{split}
    \bar{\Pi}(\pmb{u},\pmb \lambda)=\Pi(\pmb{u})-\int_{\Gamma^g}\lambda_i(u_i-g_i)d\Gamma
\end{split}
\end{equation}   
对式(\ref{Elambda})进行变分可以得到拉格朗日乘子法的等效积分弱形式：
\begin{equation}\label{Elambda weakform}
        \delta\bar{\Pi}(\pmb{u},\pmb{\lambda})=\Pi(\pmb{u})-\int_{\Gamma^g}\delta u_i\lambda_id\Gamma-\int_{\Gamma^g}\delta\lambda_i(u_i-g_i)d\Gamma=0
\end{equation}\par
通常情况下拉格朗日乘子$\pmb{\lambda}$及其变分$\delta\pmb{\lambda}$可采用有限元形函数进行离散，相应的分量为：
\begin{equation}\label{lambdalisan}
\lambda_i(\pmb{x})=\sum_{I=1}^{N\!L}N_I(\pmb{x})\lambda_{iI},\quad
\delta\lambda_i(\pmb{x})=\sum_{I=1}^{N\!L}N_I(\pmb{x})\delta\lambda_{iI}
\end{equation}
其中$N\!L$表示离散拉格朗日乘子的个数，$N_I(\pmb{x})$为有限元函数。\par
将式(\ref{displacement vector})、(\ref{strainh})、(\ref{strain vector})和(\ref{lambdalisan})代入到弱形式(\ref{Elambda weakform})中得弹性力学问题的离散平衡控制方程式：
\begin{equation}
    \begin{bmatrix}\pmb{K}&\pmb{K}^{(u\lambda)}\\\pmb{K}^{(u\lambda) T}&\pmb{0}\end{bmatrix}
    \left\{\begin{matrix}\pmb{d}\\\pmb{\lambda}\end{matrix}\right\}=
    \left\{\begin{matrix}\pmb{f}\\\pmb{f}^{\lambda}\end{matrix}\right\}
\end{equation}
其中$\pmb{K}$、$\pmb{f}$为传统的刚度矩阵和力向量，其表达式见式(\ref{EKf})。$\pmb{K}^{(u\lambda)}$和$\pmb{f}^{\lambda}$的分量具体表达式如下：
\begin{subequations}
\begin{align}
    \pmb K_{IJ}^{u\lambda}&=-\int_{\Gamma^g}\Psi_IN_J \boldsymbol 1d\Gamma\\
    \pmb f_I^{\lambda}&=-\int_{\Gamma^g}N_I\pmb{g}d\Gamma
\end{align}
\end{subequations}
式中$\boldsymbol 1$为$2\times2$单位矩阵。
\par
同样地在薄板问题势能泛函中(\ref{Pshineng})引入拉格朗日乘子$\lambda_w$、$\lambda_\theta$、$\lambda_c$施加本质边界条件，可得到如下表达式：
\begin{multline}\label{Plambda}
    \bar{\Pi}(w,\lambda_w,\lambda_{\theta},\lambda_c)=\Pi(w) \\ -\int_{\Gamma_w}\lambda_w(w-\bar{w})d\Gamma
    +\int_{\Gamma_{\theta}}\lambda_{\theta}(\theta_{\pmb n}-\bar{\theta}_{\pmb n})d\Gamma
    -\lambda_c(w-\bar{w})\vert_{x\in c_w}
\end{multline}
对式(\ref{Plambda})进行变分可以得到相应的等效积分弱形式：
\begin{equation}\label{Plambda weakform}
\begin{split}
    \delta\bar{\Pi}(w,\lambda_w,\lambda_{\theta},\lambda_c)&=\delta\Pi(w)\\
    &-\int_{\Gamma_w}\delta w\lambda_wd\Gamma+\int_{\Gamma_{\theta}}\delta\theta_{\pmb n}\lambda_\theta d\Gamma-\delta w\lambda_c\vert_{x\in c_w}\\
    &-\int_{\Gamma_w}\delta\lambda_w(w-\bar{w})d\Gamma+\int_{\Gamma_{\theta}}\delta\lambda_\theta(\theta_{\pmb n}-\bar{\theta}_{\pmb n})d\Gamma-\delta\lambda_c(w-\bar{w})\vert_{x\in c_w}\\
    &=0
\end{split}
\end{equation}
进一步采用有限元形函数离散拉格朗日乘子$\lambda_w$、$\lambda_\theta$和$\lambda_c$：
\begin{equation}\label{lambda_3}
\lambda_w(\pmb{x})=\sum_{I=1}^{N\!L}N_I(\pmb{x})\lambda_{wI},\quad
\lambda_\theta(\pmb{x})=\sum_{I=1}^{N\!L}N_I(\pmb{x})\lambda_{\theta I},\quad
\lambda_c(\pmb{x})=\sum_{I=1}^{N\!L}N_I(\pmb{x})\lambda_{cI}
\end{equation}
将式(\ref{wn})、(\ref{Malphabeta})、(\ref{Pwuwangelisan})和(\ref{lambda_3})代入到弱形式(\ref{Plambda weakform})中可得薄板问题拉格朗日乘子法的离散控制方程式：
\begin{equation}
    \begin{split}
     \begin{bmatrix}\pmb{K}&\pmb{K}^{w\lambda_w}&\pmb{K}^{w\lambda_\theta}&\pmb{K}^{w\lambda_c}\\
     \pmb{K}^{w\lambda_w T}&\pmb 0&\pmb 0&\pmb 0\\
     \pmb{K}^{w\lambda\theta T}&\pmb 0&\pmb 0&\pmb 0\\
     \pmb{K}^{w\lambda_c T}&\pmb 0&\pmb 0&\pmb 0\\
     \end{bmatrix}
     \left\{\begin{matrix}
     \pmb{d}\\\pmb \lambda_w\\\pmb \lambda_{\theta}\\\pmb\lambda_c
     \end{matrix}\right\}=
     \left\{\begin{matrix}
     \pmb{f}\\\pmb f^{\lambda_w}\\\pmb f^{\lambda_\theta}\\\pmb f^{\lambda_c}
     \end{matrix}\right\}
\end{split}
\end{equation}
其中刚度矩阵$\pmb{K}$、力向量$\pmb{f}$表达式见式(\ref{PKf})。$\pmb K^{w\lambda_w}$、$\pmb K^{w\lambda_\theta}$、$\pmb K^{w\lambda_c}$、$\pmb f^{\lambda_w}$、$\pmb f^{\lambda_\theta}$、$\pmb f^{\lambda_c}$分量的表达式分别为：
\begin{subequations}
\begin{align}
    K_{IJ}^{w\lambda_w}&=-\int_{\Gamma_w}\Psi_IN_J^{\lambda_w}d\Gamma\\
    K_{IJ}^{w\lambda_\theta}&=\int_{\Gamma_\theta}\Psi_{I,\alpha}n_\alpha(\pmb{x})N_J^{\lambda_\theta}d\Gamma\\
    K_{IJ}^{w\lambda_c}&=-\Psi_I(\pmb{x})N_J^{\lambda_c}\vert_{c\in c_w}\\
    f_I^{\lambda_w}&=\int_{\Gamma_w}N_I^{\lambda_w}\bar{w}d\Gamma\\
    f_I^{\lambda_\theta}&=-\int_{\Gamma_\theta}N_I^{\lambda_\theta}\bar{\theta}_nd\Gamma\\
    f_I^{\lambda_c}&=-N_I^{\lambda_c}\bar{w}\vert_{c\in c_w}
\end{align}
\end{subequations}\par
拉格朗日乘子法在数值计算中广泛应用，特别适用于处理约束条件，在伽辽金无网格法求解过程中应用广泛，可满足变分的一致性。
然而，拉格朗日乘子法需引入额外自由度离散拉格朗日乘子，其刚度矩阵也变成了奇异矩阵。当拉格朗日乘子自由度过多时，将增加整体刚度矩阵的奇异性，导致计算精度下降。尤其在薄板问题中通常涉及大量的自由度和约束条件，刚度矩阵奇异性问题更为显著。
\section{罚函数法}
罚函数法\cite{zhu1998}是在势能泛函中通过引入罚函数项进行本质边界条件的施加，罚函数项为罚因子$\alpha$乘以边界条件残差的平方。在弹性力学问题势能泛函表达式(\ref{elasticity potential functional})中引入罚函数项有：
\begin{equation}\label{Epenalty}
    \bar{\Pi}(\pmb{u})=\Pi(\pmb{u})+\frac{1}{2}\alpha\int_{\Gamma^g}(u_i-g_i)(u_i-g_i)d\Gamma
\end{equation}
对式(\ref{Epenalty})进行变分可以得到施加本质边界条件罚函数法的等效积分弱形式：
\begin{equation}\label{Epenalty weakform}
    \delta\bar{\Pi}(\pmb{u})=\delta\Pi(\pmb{u})+\alpha\int_{\Gamma^g}\delta u_iu_id\Gamma-\alpha\int_{\Gamma^g}\delta u_ig_id\Gamma
    =0                                              
\end{equation}\par
引入无网格离散式(\ref{displacement vector})、(\ref{strainh})和(\ref{strain vector})代入到弱形式(\ref{Epenalty weakform})中得到弹性力学问题施加本质边界条件罚函数法的离散平衡控制方程式：
\begin{equation}
    (\pmb{K}+\pmb{K}^s)\pmb{d}=\pmb{f}+\pmb{f}^s
\end{equation}
其中$\pmb{K}$、$\pmb{f}$见式(\ref{EKf})，$\pmb K^s_{IJ}$和$\pmb f^s_I$的具体表达式为：
\begin{subequations}\label{EKFs}
\begin{align}
  \pmb K^s_{IJ}&=\alpha\int_{\Gamma^g}\Psi_I\Psi_J\boldsymbol 1d\Gamma\\
  \pmb f^s_I&=\alpha\int_{\Gamma^g}N_I\pmb{g}d\Gamma
\end{align}
\end{subequations}\par
薄板问题势能泛函表达式(\ref{Pshineng})通过引入3个不通的罚因子$\alpha_w$、$\alpha_\theta$和$\alpha_c$施加本质边界条件，其表达式为：
\begin{multline}\label{Ppenalty}
        \bar{\Pi}(w)=\Pi(w)\\
    +\frac{\alpha_w}{2}\int_{\Gamma_w}(w-\bar{w})^2d\Gamma+\frac{\alpha_{\theta}}{2}\int_{\Gamma_{\theta}}(\theta_{\pmb{n}}-\bar{\theta}_{\pmb{n}})^2d\Gamma+\frac{\alpha_c}{2}(w-\bar{w})^2\vert_{x\in c_w}
\end{multline}
对式(\ref{Ppenalty})进行变分可以得到施加本质边界条件罚函数法的等效积分弱形式：
\begin{equation}\label{Ppenalty weakform}
\begin{split}
  \delta\bar{\Pi}(w)&=\delta\Pi(w)\\
  &+\alpha_w\int_{\Gamma_w}\delta w(w-\bar{w})d\Gamma+\alpha_\theta\int_{\Gamma_{\theta}}\delta\theta_{\pmb n}(\theta_{\pmb n}-\bar{\theta}_{\pmb n})d\Gamma+\alpha_c(w-\bar{w})\vert_{x\in c_w}\\
  &=0
\end{split}
\end{equation}\par
引入式(\ref{wn})、(\ref{Malphabeta})和(\ref{Pwuwangelisan})代入到弱形式(\ref{Ppenalty weakform})中得到薄板问题施加本质边界条件罚函数法的离散平衡控制方程式：
\begin{equation}
    (\pmb{K}+\pmb{K}^s)\pmb{d}=\pmb{f}+\pmb{f}^s
\end{equation}
其中刚度矩阵$\pmb{K}$、力向量$\pmb{f}$见式(\ref{PKf})，$\pmb K^s_{IJ}$和$\pmb f^s_I$的具体表达式为：
\begin{subequations}\label{PKFs}
\begin{align}
   K^s_{IJ}&=\alpha_w\int_{\Gamma_w}\Psi_I\Psi_Jd\Gamma+\alpha_{\theta}\int_{\Gamma_{\theta}}\Psi_{I,\pmb n}\Psi_{J,\pmb n}d\Gamma+\alpha_c\Psi_I\Psi_J\vert_{x\in c_w}\\
f^s_I&=\alpha_w\int_{\Gamma_w}\Psi_I\bar{w}d\Gamma+\alpha_{\theta}\int_{\Gamma_{\theta}}\Psi_{I,\pmb n}\bar{\theta}_{\pmb n}d\Gamma+\alpha_c\Psi_I\bar{w}\vert_{x\in c_w}
\end{align}
\end{subequations}\par
值得注意的是，罚函数法不满足变分一致性，并且在使用过程中罚因子大小决定了伽辽金法的计算精度。
较大的罚因子可能会导致数值不稳定或者收敛困难，而较小的罚因子可能会导致边界条件无法满足。
尤其在薄板问题中，最优的罚因子取值跟节点离散尺寸相关，且3种罚因子跟节点离散尺寸的相关性不同，难以保证计算精度。
\section{Nitsche法}
Nitsche法\cite{fernandez-mendez2004}是目前变分一致型无网格法最常采用的本质边界条件施加方法，其可视为拉格朗日乘子法与罚函数法相结合。首先将拉格朗日乘子采用相对应的物理意义表示，此时拉格朗日乘子可用传统位移节点进行离散，无需引入额外自由度，保证了变分一致性和刚度矩阵对称性。然而，此时刚度矩阵通常不具有正定性，需引入罚函数项进行稳定，保证计算精度。\par
在弹性力学问题中，拉格朗日乘子的物理意义为约束反力，即$\lambda_i=\sigma_{ij}n_i$。
并引入罚函数法，此时等效积分弱形式(\ref{Elambda weakform})中可改写为：
\begin{equation}\label{Enitsche}
    \bar{\Pi}(\pmb{u})=\Pi(\pmb{u})-\int_{\Gamma^g}\sigma_{ij}n_j(u_i-g_i)d\Gamma+\frac{1}{2}\alpha\int_{\Gamma^g}(u_i-g_i)(u_i-g_i)d\Gamma
\end{equation}
对式(\ref{Enitsche})进行变分得到相对应的等效积分弱形式：
\begin{equation}\label{Enitsche weakform}
\begin{split}
    \delta\bar{\Pi}(\pmb{u})&=\delta\Pi(\pmb{u})-\int_{\Gamma^g}\delta u_i\sigma_{ij}n_jd\Gamma-\int_{\Gamma^g}\delta\sigma_{ij}n_j(u_i-g_i)d\Gamma\\
    &+\alpha\int_{\Gamma^g}\delta u_iu_id\Gamma-\alpha\int_{\Gamma^g}\delta u_i g_id\Gamma\\
    &=0
\end{split}
\end{equation}\par
% 在伽辽金无网格法中，面力$\sigma_{ij}n_i$的无网格离散形式可以表示为：
% \begin{equation}\label{Esigman wuwanggelisan}
%     n_i\sigma_{ij}=\bar{n}_i^T\sigma_{ij}=\bar{n}_i^T\pmb{D}\varepsilon^h=\sum_{I=1}^{N\!P}\bar{\pmb n}^T\pmb D\pmb{B}_I\pmb{d}_I
% \end{equation}
% 其中$\bar{\pmb{n}}$在平面问题中的表达式为：
% \begin{equation}
% \begin{split}
%     \bar{\pmb n}=\left[\begin{matrix}n_1&0\\0&n_2\\n_2&n_1
%     \end{matrix}\right]
% \end{split}
% \end{equation}\par
% 其次为了满足正定性，通过引入罚因子$\alpha$结合罚函数法得到如下表达式：
% \begin{equation}\label{Enitsche}
% \begin{split}
%     \bar{\Pi}(\pmb{u})=\Pi(\pmb{u})-\int_{\Gamma^g}n_i\sigma_{ij}(u_i-g_i)d\Gamma+\frac{1}{2}\alpha\int_{\Gamma^g}(u_i-g_i)(u_i-g_i)d\Gamma
% \end{split}
% \end{equation}
% 对式(\ref{Enitsche})进行变分得到弹性力学问题施加本质边界条件Nistche法的等效积分弱形式：
% \begin{equation}\label{Enitsche weakform}
% \begin{split}
%     \delta\bar{\Pi}(\pmb{u})&=\delta\Pi(\pmb{u})-\int_{\Gamma^g}\delta u_i\sigma_{ij}n_id\Gamma-\int_{\Gamma^g}n_i\delta\sigma_{ij}(u_i-g_i)d\Gamma\\
% &+\alpha\int_{\Gamma^g}\delta u_iu_id\Gamma-\alpha\int_{\Gamma^g}\delta u_i g_id\Gamma\\
% &=0
% \end{split}
% \end{equation}\par
引入无网格离散式(\ref{displacement vector})、式(\ref{strainh})和(\ref{strain vector})代入到弱形式(\ref{Enitsche weakform})中得到弹性力学问题施加本质边界条件Nitsche法的离散控制方程式：
\begin{equation}
    (\pmb{K}+\pmb{K}^v+\pmb{K}^s)\pmb{d}=\pmb{f}+\pmb{f}^v+\pmb{f}^s
\end{equation}
其中刚度矩阵$\pmb{K}$和力向量$\pmb{f}$见式(\ref{EKf})，通过罚函数法满足正定性得到的稳定项$\pmb{K}^s$和$\pmb{f}^s$见式(\ref{EKFs})，结合拉格朗日乘子法满足变分一致性的修正变分项$\pmb{K}^v$和$\pmb{f}^v$，其具体表达式如下：
\begin{subequations}\label{Enitschekv}
\begin{align} 
    \pmb K^v_{IJ}&=-\int_{\Gamma^g}\Psi_I\bar{\pmb{n}}^T\pmb{D}\pmb{B}_Jd\Gamma-\int_{\Gamma^g}\pmb{B}_I^T\pmb{D}\bar{\pmb{n}}\Psi_Jd\Gamma\\
    \pmb f^v_I&=-\int_{\Gamma^g}\pmb{B}_I^T\pmb{D}\bar{\pmb{n}}\pmb{g}d\Gamma
\end{align}
\end{subequations}
式中矩阵$\bar{\pmb{n}}$为法向量矩阵，在平面问题中的表达式为：
\begin{equation}
\begin{split}
    \bar{\pmb n}=\begin{bmatrix}n_1&0\\0&n_2\\n_2&n_1
    \end{bmatrix}
\end{split}
\end{equation}\par
同样地在薄板问题中，拉格朗日乘子$\lambda_w$、$\lambda_\theta$和$\lambda_c$分别用等效剪力$V_{\pmb n}$、法向弯矩$M_{\pmb{nn}}$和薄板角上的集中荷载$P$进行替换，并通过罚函数法引入三个不同的罚因子$\alpha_w$、$\alpha_\theta$和$\alpha_c$，此时等效积分弱形式(\ref{Pweakform})可改写：
\begin{equation}\label{Pnitsche}
\begin{split}
    \bar{\Pi}(w)&=\Pi(w)\\
    &-\int_{\Gamma_w}V_{\pmb{n}}(w-\bar{w})d\Gamma+\int_{\Gamma_{\theta}}M_{\pmb{nn}}(\theta_{\pmb{n}}-\bar{\theta}_{\pmb{n}})d\Gamma-P(w-\bar{w})\vert_{x\in c_w}\\
    &+\frac{\alpha_w}{2}\int_{\Gamma_w}(w-\bar{w})^2d\Gamma+\frac{\alpha_{\theta}}{2}\int_{\Gamma_{\theta}}(\theta_{\pmb{n}}-\bar{\theta}_{\pmb{n}})^2d\Gamma+\frac{\alpha_c}{2}(w-\bar{w})^2\vert_{x\in c_w}
\end{split}
\end{equation}
% 对式(\ref{Psigman})进行变分得到施加本质边界条件修正变分原理法的等效积分弱形式：
% \begin{equation}
% \begin{split}
%     &\int_{\Omega}\delta\kappa_{,\alpha\beta}M_{\alpha\beta}d\Omega-\int_{\Gamma_w}(\delta V_{\pmb{n}}w+\delta wV_{\pmb{n}})d\Gamma+\int_{\Gamma_{\theta}}(\delta M_{\pmb{nn}}\theta_{\pmb{n}}+\delta\theta_{\pmb{n}}M_{\pmb{nn}})d\Gamma\\
%     &-(\delta Pw+\delta wP)\vert_{x\in c_w}=\int_{\Gamma_M}\delta\theta_{\pmb{n}}\bar{M}_{\pmb{nn}}d\Gamma-\int_{\Gamma_V}\delta w\bar{V}_{\pmb{n}}d\Gamma-\delta w\bar{P}\vert_{x\in c_P}\\
%     &+\int_{\Omega}\delta w\bar{q}d\Omega-\int_{\Gamma_w}\delta V_{\pmb{n}}\bar{w}d\Gamma+\int_{\Gamma_{\theta}}\delta M_{\pmb{nn}}\bar{\theta}_{\pmb{n}}d\Gamma-\delta P\bar{w}\vert_{x\in c_w}
% \end{split}
% \end{equation}\par
% 为了满足正定性，进一步引入罚因子$\alpha_w$、$\alpha_\theta$和$\alpha_c$结合罚函数法得到如下表达式：
% \begin{equation}\label{Pnitsche}
% \begin{split}
%     \bar{\Pi}(w)&=\frac{1}{2}\int_{\Omega}\kappa_{,\alpha\beta}M_{\alpha\beta}d\Omega+\int_{\Gamma_M}\theta_{\pmb{n}}\bar{M}_{\pmb{nn}}d\Gamma-\int_{\Gamma_V}w\bar{V}_{\pmb{n}}d\Gamma-w\bar{P}\vert_{x\in c_P}+\int_{\Omega}w\bar{q}d\Omega\\
% &-\int_{\Gamma_w}V_{\pmb{n}}(w-\bar{w})d\Gamma+\int_{\theta}M_{\pmb{nn}}(\theta_{\pmb{n}}-\bar{\theta}_{\pmb{n}})d\Gamma-P(w-\bar{w})\vert_{x\in c_w}\\
% &+\frac{\alpha_w}{2}\int_{\Gamma_w}(w-\bar{w})^2d\Gamma+\frac{\alpha_{\theta}}{2}\int_{\Gamma_{\theta}}(\theta_{\pmb{n}}-\bar{\theta}_{\pmb{n}})^2d\Gamma+\frac{\alpha_c}{2}(w-\bar{w})^2\vert_{x\in c_w}
% \end{split}
% \end{equation}
将式(\ref{Qn})、(\ref{Mn})、(\ref{Malphabeta})、(\ref{Dalphabeta})代入式(\ref{P control equation})中，从而将$M_{\pmb{nn}}$、$V_{\pmb n}$和$P$采用挠度$w$表示为：
\begin{equation}
\begin{cases}\label{MVP}
        M_{\pmb{nn}}=\mathcal{M}_{\alpha\beta}w_{,\alpha\beta}=-\bar{D}(\nu\delta_{\alpha\beta}+(1-\nu)n_{\alpha}n_{\beta})w_{,\alpha\beta}\\
        V_{\pmb{n}}=\mathcal{V}_{\alpha\beta}w_{,\alpha\beta}=-\bar{D}(\frac{\partial}{\partial x_{\alpha}}n_{\beta}+(1-\nu)n_{\alpha}\frac{\partial}{\partial y_{\gamma}}s_{\alpha}n_{\beta}s_{\gamma})w_{,\alpha\beta}\\
        P=\mathcal{P}_{\alpha\beta}w_{,\alpha\beta}=-[[(\bar{D}(1-\nu)n_{\alpha}s_{\beta})w_{,\alpha\beta}]]
\end{cases}
\end{equation}
其中
\begin{equation}
\begin{cases}\label{MVP1}
 \mathcal{M}_{\alpha\beta}=-D_{\alpha\beta\gamma\eta}n_{\gamma}n_{\eta}=-\bar{D}(\nu\delta_{\alpha\beta}+(1-\nu)n_{\alpha}n_{\beta})\\
  \mathcal{V}_{\alpha\beta}=-D_{\alpha\beta\gamma\eta}(n_{\gamma}\frac{\partial}{\partial x_{\eta}}+s_{\gamma}n_{\eta}s_{\xi}\frac{\partial}{\partial x_{\xi}})
  =-\bar{D}(\frac{\partial}{\partial x_{\alpha}}n_{\beta}+(1-\nu)n_{\alpha}\frac{\partial}{\partial y_{\gamma}}s_{\alpha}n_{\beta}s_{\gamma})\\
 \mathcal{P}_{\alpha\beta}=-[[D_{\alpha\beta}n_{\gamma}s_{\eta}]]=-[[\bar{D}(1-\nu)n_{\alpha}s_{\beta}]]
\end{cases}
\end{equation}\par
对式(\ref{Pnitsche})进行变分得到薄板问题施加本质边界条件Nitshce法的等效积分弱形式为：
% \begin{equation}\label{Pitsche weakform}
% \begin{split}
% &\int_{\Omega}\delta\kappa_{,\alpha\beta}M_{\alpha\beta}d\Omega-\int_{\Gamma_w}(\delta V_{\pmb{n}}w+\delta wV_{\pmb{n}})d\Gamma+\int_{\Gamma_{\theta}}(\delta M_{\pmb{nn}}\theta_{\pmb{n}}+\delta\theta_{\pmb{n}}M_{\pmb{nn}})d\Gamma\\&-(\delta Pw+\delta wP)\vert_{x\in c_w}
% +\alpha_w\int_{\Gamma_w}\delta wwd\Gamma+\alpha_{\theta}\int_{\Gamma_{\theta}}\delta\theta_{\pmb{n}}\theta_{\pmb{n}}d\Gamma+\alpha_c\delta ww\vert_{x\in c_w}\\
% &=\int_{\Gamma_M}\delta\theta_{\pmb{n}}\bar{M}_{\pmb{nn}}d\Gamma-\int_{\Gamma_V}\delta w\bar{V}_{\pmb{n}}d\Gamma-\delta w\bar{P}\vert_{x\in c_P}+\int_{\Omega}\delta w\bar{q}d\Omega
% -\int_{\Gamma_w}\delta V_{\pmb{n}}\bar{w}d\Gamma\\&+\int_{\Gamma_{\theta}}\delta M_{\pmb{nn}}\bar{\theta}_{\pmb{n}}d\Gamma-\delta P\bar{w}\vert_{x\in c_w}
% +\alpha_w\int_{\Gamma_w}\delta w\bar{w}d\Gamma+\alpha_{\theta}\int_{\Gamma_{\theta}}\delta\theta_{\pmb{n}}\bar{\theta}_{\pmb{n}}d\Gamma+\alpha_c\delta w\bar{w}\vert_{x\in c_w}
% \end{split}
% \end{equation}\par
\begin{equation}\label{Pitsche weakform}
\begin{split}
    \delta\bar{\Pi}(w)&=\delta\Pi(w)\\
 &-\int_{\Gamma_w}\delta V_{\pmb n}(w-\bar{w})d\Gamma+\int_{\Gamma_{\theta}}\delta M_{\pmb{nn}}(\theta_{\pmb n}-\bar{\theta}_{\pmb n})d\Gamma-\delta P(w-\bar{w})\vert_{x\in c_w}\\
 &-\int_{\Gamma_w}\delta wV_{\pmb n}d\Gamma+\int_{\Gamma_{\theta}}\delta\theta_{\pmb n}M_{\pmb{nn}}d\Gamma-\delta wP\vert_{x\in c_w}\\
 &+\alpha_w\int_{\Gamma_w}\delta w(w-\bar{w})d\Gamma+\alpha_\theta\int_{\Gamma_{\theta}}\delta\theta_{\pmb n}(\theta_{\pmb n}-\bar{\theta}_{\pmb n})d\Gamma+\alpha_c(w-\bar{w})\vert_{x\in c_w}
\end{split}
\end{equation}\par
进一步引入无网格离散式(\ref{Pwuwangelisan})、式(\ref{wn})-(\ref{kangwangangdu})和式(\ref{MVP})、(\ref{MVP1})得到薄板问题施加本质边界条件Nitsche法的离散控制方程式：
\begin{equation}
    (\pmb{K}+\pmb{K}^v+\pmb{K}^s)\pmb{d}=\pmb{f}+\pmb{f}^v+\pmb{f}^s
\end{equation}
其中刚度矩阵$\pmb{K}$和力向量$\pmb{f}$见式(\ref{PKf})。$\pmb{K}^s$和$\pmb{f}^s$的表达式与罚函数法式(\ref{PKFs})相同，该项使得伽辽金弱形式(\ref{Pitsche weakform})满足正定性条件，稳定求解精度，故称之为\textbf{稳定项}。$\pmb{K}^v$和$\pmb{f}^v$可使伽辽金弱形式整体满足变分一致性，故称之为\textbf{修正变分项}，修正变分项的具体表达式如下：
\begin{subequations}\label{Pkv}
\begin{align}
 K^v_{IJ}&=-\int_{\Gamma_w}\Psi_I\mathcal{V}_{\alpha\beta}\Psi_{J,\alpha\beta}d\Gamma+\int_{\Gamma_{\theta}}\Psi_{I,n}\mathcal{M}_{\alpha\beta}\Psi_{J,\alpha\beta}d\Gamma+[[\Psi_I\mathcal{P}_{\alpha\beta}\Psi_{J,\alpha\beta}]]_{x\in{c_w}}\nonumber\\
     &-\int_{\Gamma_w}\mathcal{V}_{\alpha\beta}\Psi_{I,\alpha\beta}\Psi_Jd\Gamma+\int_{\Gamma_{\theta}}\mathcal{M}_{\alpha\beta}\Psi_{I,\alpha\beta}\Psi_{J,n}d\Gamma+[[\mathcal{P}_{\alpha\beta}\Psi_{I,\alpha\beta}\Psi_J]]_{x\in{c_w}}\\
 f_{I}^v&=-\int_{\Gamma_w}\mathcal{V}_{\alpha\beta}\Psi_{I,\alpha\beta}\bar{w}d\Gamma+\int_{\Gamma_{\theta}}\mathcal{M}_{\alpha\beta}\Psi_{I,\alpha\beta}\bar{\theta}_{\pmb n}d\Gamma+[[\mathcal{P}_{\alpha\beta}\Psi_{I,\alpha\beta}\bar{w}]]_{x\in{c_w}}
\end{align}
\end{subequations}
\par
值得注意的是，Nische法作为目前伽辽金无网格法常采用的满足变分一致性的本质边界条件施加方法，但Nistche法的稳定项中包含罚因子，选择不当的罚因子可能会导致数值不稳定性，
同时修正变分项中需要计算无网格形函数梯度，特别是薄板问题Nitsche法中的修正变分项需要原本不需要计算的形函数三阶导数。形函数高阶导数计算复杂耗时，将引起计算效率的降低。
\section{小结}
本章介绍了3种伽辽金无网格法本质边界条件施加方法，包括拉格朗日乘子法、罚函数法和Nitsche法，并对这些方法的特点进行了总结。
首先是拉格朗日乘子法，拉格朗日乘子法通过引入拉格朗日乘子来处理本质边界条件，满足刚度矩阵的对称性和变分一致性。然而，该方法需引入额外自由度离散拉格朗日乘子，当自由度过多时，可能导致整体刚度矩阵的奇异性增加。
其次是罚函数法。罚函数法通过在变分原理中引入一个罚因子，将边界条件约束项转化为一个惩罚项，从而实现边界条件的施加。罚函数法具有简洁高效的特点，但需要选择合适的罚因子，过大或过小的罚因子都会影响计算精度的稳定性，并且该方法无法满足变分一致性。
最后是Nitsche法，Nitsche法是一种满足变分一致性的本质边界条件施加方法，通过结合拉格朗日乘子法和罚函数法施加边界条件，既能满足变分一致性又可保证正定性。然而，该方法引入了形函数高阶梯度导致计算效率相对较低，并且该方法中存在人工经验参数，该参数选取不当将引起计算精度下降。




